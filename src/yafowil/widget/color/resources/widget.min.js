!function(e,t){"use strict";class s{constructor(e,s){this.widget=e,this.elem=t("<div />").addClass("color-swatch").css("background-color",`hsl(${s.h}, ${s.s}%, ${s.l}%)`).appendTo(this.widget.swatches_container),this.color=s,this.destroy=this.destroy.bind(this),this.select=this.select.bind(this),this.select(),this.elem.on("click",this.select)}find_match(e){}destroy(){this.elem.off("click",this.select),this.elem.remove()}select(e){t("div.color-swatch").removeClass("selected"),this.elem.addClass("selected"),this.widget.active_swatch=this,this.widget.picker.color.hsl=this.color}}class i{constructor(e,s){this.widget=e,this.elem=t("<div />").addClass("hsl-display").appendTo(e.dropdown_elem);let i=t("<div />").addClass("hue").text("H:").appendTo(this.elem),h=t("<div />").addClass("saturation").text("S:").appendTo(this.elem),o=t("<div />").addClass("lightness").text("L:").appendTo(this.elem);this.hue_input=t("<input />").addClass("h").attr({type:"number",min:0,max:360}).val(s.h).appendTo(i),this.saturation_input=t("<input />").addClass("s").attr({type:"number",min:0,max:100}).val(s.s).appendTo(h),this.lightness_input=t("<input />").addClass("l").attr({type:"number",min:0,max:100}).val(s.l).appendTo(o),this.update=this.update.bind(this),this.hue_input.add(this.saturation_input).add(this.lightness_input).on("input",this.update)}get value(){return{h:parseInt(this.hue_input.val()),s:parseInt(this.saturation_input.val()),l:parseInt(this.lightness_input.val())}}set value(e){this.hue_input.val(e.h),this.saturation_input.val(e.s),this.lightness_input.val(e.l)}update(e){this.widget.picker.color.hsl=this.value}}class h{constructor(e,s){this.widget=e,this.elem=t("<div />").addClass("hex-display").text("HEX:").appendTo(e.dropdown_elem),this.input=t("<input />").val(s).attr({spellcheck:!1,maxlength:7}).appendTo(this.elem),this.update=this.update.bind(this),this.input.on("input",this.update)}get value(){return this.input.val()}set value(e){this.input.val(e)}update(){0===this.value.length?this.input.val("#"):this.widget.parse_hex(this.input.val())&&(this.widget.picker.color.hexString=this.value)}}class o{static initialize(e){t("input.color-picker",e).each((function(){new o(t(this),{hsl_display:!0,hex_display:!0})}))}constructor(e,i){this.elem=e,this.elem.data("color_widget",this).attr("spellcheck","false").attr("maxlength",7),this.dropdown_elem=t("<div />").addClass("color-picker-wrapper"),this.picker_container=t("<div />").addClass("color-picker-container").appendTo(this.dropdown_elem),this.close_btn=t("<button />").addClass("close-button").text("âœ•").appendTo(this.dropdown_elem),this.add_color_btn=t("<button />").addClass("add_color").text("+ Add"),this.remove_color_btn=t("<button />").addClass("remove_color").text("- Remove"),this.buttons=t("<div />").addClass("buttons").append(this.add_color_btn).append(this.remove_color_btn).appendTo(this.dropdown_elem),this.swatches_container=t("<div />").addClass("color-picker-recent").appendTo(this.dropdown_elem),this.picker=new iro.ColorPicker(this.picker_container.get(0),{color:"#ffffff",layout:[{component:iro.ui.Box,options:{}},{component:iro.ui.Slider,options:{sliderType:"hue"}}]}),this.color_swatches=[],this.init_options(i);let h=localStorage.getItem("color-swatches");if(h){let e=JSON.parse(h);this.swatches_container.show();for(let t of e)this.color_swatches.push(new s(this,t));this.color_swatches[this.color_swatches.length-1].select()}this.color=this.picker.color.clone(),this.elem.val(this.color.hexString),this.preview_elem.css("background-color",`hsl(${this.color.hsl.h}, ${this.color.hsl.s}%, ${this.color.hsl.l}%)`),this.resize_handle=this.resize_handle.bind(this),this.resize_handle(),t(window).on("resize",this.resize_handle),this.create_swatch=this.create_swatch.bind(this),this.add_color_btn.on("click",this.create_swatch),this.remove_swatch=this.remove_swatch.bind(this),this.remove_color_btn.on("click",this.remove_swatch),this.trigger_handle=this.trigger_handle.bind(this),this.elem.on("focus",this.trigger_handle),this.preview_elem.on("click",this.trigger_handle),this.elem.on("input",(()=>{let e=this.elem.val();0===e.length?this.elem.val("#"):this.parse_hex(e)&&(this.picker.color.hexString=e)})),this.update_color=this.update_color.bind(this),this.picker.on("color:change",this.update_color),this.close=this.close.bind(this),this.close_btn.on("click",this.close),this.handle_keypress=this.handle_keypress.bind(this),this.handle_click=this.handle_click.bind(this)}init_options(e){e&&e.preview_elem?(this.preview_elem=e.preview_elem,this.elem.after(this.dropdown_elem)):(this.preview_elem=t("<span />").addClass("color-picker-color"),this.elem.after(this.preview_elem),this.preview_elem.after(this.dropdown_elem)),e&&e.hsl_display?this.hsl_display=new i(this,this.picker.color.hsl):this.buttons.addClass("hsl-false"),e&&e.hex_display&&(this.hex_display=new h(this,this.picker.color.hexString))}resize_handle(e){if(t(window).width()<=450){this.dropdown_elem.hasClass("mobile")||(this.dropdown_elem.addClass("mobile"),this.picker.state.layoutDirection="horizontal");let e=.3*t(window).width();this.picker.resize(e)}else t(window).width()>450&&this.dropdown_elem.hasClass("mobile")&&(this.dropdown_elem.removeClass("mobile"),this.picker.state.layoutDirection="vertical",this.picker.resize(300))}parse_hex(e){return"string"==typeof e&&"#"===e[0]&&7===e.length&&!isNaN(Number("0x"+e.substring(1,7)))}update_color(){this.color=this.picker.color.clone(),this.preview_elem.css("background",this.color.hexString),this.elem.val(this.color.hexString),this.hsl_display&&(this.hsl_display.value=this.color.hsl),this.elem.val(this.color.hexString),this.hex_display&&(this.hex_display.value=this.color.hexString)}trigger_handle(e){"none"===this.dropdown_elem.css("display")?(this.dropdown_elem.show(),t(window).on("keydown",this.handle_keypress),t(window).on("mousedown",this.handle_click)):this.close()}handle_keypress(e){"Enter"===e.key||"Escape"===e.key?(e.preventDefault(),this.close()):"Delete"===e.key&&(e.preventDefault(),this.remove_swatch())}handle_click(e){let t=this.dropdown_elem;t.is(e.target)||0!==t.has(e.target).length||this.preview_elem.is(e.target)||"block"!==t.css("display")||this.close()}close(e){e&&e.preventDefault(),this.dropdown_elem.hide(),this.elem.blur(),t(window).off("keydown",this.handle_keypress),t(window).off("mousedown",this.handle_click)}create_swatch(e){e&&(e.preventDefault(),this.swatches_container.show()),this.color_swatches.push(new s(this,this.picker.color.hsl)),this.color_swatches.length>12&&(this.color_swatches[0].destroy(),this.color_swatches.shift()),this.set_swatches()}remove_swatch(e){e&&e.preventDefault(),this.active_swatch.destroy();let t=this.color_swatches.indexOf(this.active_swatch);this.color_swatches.splice(t,1),0===this.color_swatches.length?(this.picker.color.reset(),localStorage.removeItem("color-swatches")):(this.active_swatch=this.color_swatches[this.color_swatches.length-1],this.active_swatch.select(),this.picker.color.hsl=this.active_swatch.color,this.set_swatches())}set_swatches(){let e=[];for(let t of this.color_swatches)e.push(t.color);localStorage.setItem("color-swatches",JSON.stringify(e))}}t((function(){void 0!==window.ts?ts.ajax.register(o.initialize,!0):o.initialize()})),e.ColorWidget=o,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.color=e}({},jQuery);
//# sourceMappingURL=widget.min.js.map
