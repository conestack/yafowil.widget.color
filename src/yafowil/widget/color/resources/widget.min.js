!function(e,s){"use strict";class i{static initialize(e){s("input.color-picker",e).each((function(){new i(s(this),{hsl_display:!0,hex_display:!0})}))}constructor(e,i){this.elem=e,this.elem.data("color_widget",this).attr("spellcheck","false").attr("maxlength",7),this.picker_elem=s('\n            <div class="color-picker-wrapper" />\n        '),this.picker_container=s('<div class="color-picker-container" />'),this.close_btn=s('\n            <button class="close-button">âœ•</button>\n        ');let t=this.add_color_btn=s('\n            <button class="add_color">\n            + Add\n            </button>\n        '),l=this.remove_color_btn=s('\n            <button class="remove_color">\n            - Remove\n            </button>\n        ');this.buttons=s('<div class="buttons"/>').append(t).append(l),this.swatches_container=s('<div class="color-picker-recent" />'),this.picker_elem.append(this.picker_container).append(this.close_btn).append(this.buttons).append(this.swatches_container),this.resize_handle=this.resize_handle.bind(this),this.resize_handle(),s(window).on("resize",this.resize_handle),this.create_swatch=this.create_swatch.bind(this),this.add_color_btn.on("click",this.create_swatch),this.remove_swatch=this.remove_swatch.bind(this),this.remove_color_btn.on("click",this.remove_swatch),this.init_options(i),this.init_swatches(),this.color="#ffffff",this.color_swatches=[],this.elem.val(this.color),this.preview_elem.css("background",this.color),this.trigger_handle=this.trigger_handle.bind(this),this.elem.on("focus",this.trigger_handle),this.preview_elem.on("click",this.trigger_handle),this.elem.on("input",(()=>{let e=this.elem.val();0===e.length&&this.elem.val("#"),this.update_hex_value(e)})),this.update_color=this.update_color.bind(this),this.picker.on("color:change",this.update_color),this.hide_elem=this.hide_elem.bind(this),this.close_btn.on("click",this.hide_elem),this.handle_keypress=this.handle_keypress.bind(this),this.handle_click=this.handle_click.bind(this)}init_options(e){if(e&&e.preview_elem?(this.preview_elem=e.preview_elem,this.elem.after(this.picker_elem)):(this.preview_elem=s('\n                <span class="color-picker-color" />\n            '),this.elem.after(this.preview_elem),this.preview_elem.after(this.picker_elem)),e&&e.hsl_display){let e=this.picker.color.hsl;this.hsl_display=s(`\n                <div class="hsl-display">\n                  <div>\n                    H:\n                    <input class="h" type="number" value="${e.h}"\n                        min="0", max="360" />\n                  </div>\n                  <div>\n                    S:\n                    <input class="s" type="number" value="${e.s}"\n                        min="0", max="100" />\n                  </div>\n                  <div>\n                    L:\n                    <input class="l" type="number" value="${e.l}"\n                        min="0", max="100" />\n                  </div>\n                </div>\n            `),this.picker_elem.append(this.hsl_display),s("input",this.hsl_display).on("input",this.update_hsl_value.bind(this))}else this.buttons.addClass("hsl-false");if(e&&e.hex_display){let e=this.hex_display=s(`\n                <div class="hex-display">\n                  HEX:\n                  <input value="${this.picker.color.hexString}"\n                    spellcheck="false" maxlength="7" />\n                </div>\n            `);this.picker_elem.append(e);let i=this.picker.color.hexString;this.hex_display.val(i),s("input",this.hex_display).on("input",(e=>{let i=s(e.currentTarget).val();0===i.length&&s(e.currentTarget).val("#"),this.update_hex_value(i)}))}}init_swatches(){let e=localStorage.getItem("color-swatches");if(e){this.swatches_container.show(),this.color_swatches=JSON.parse(e);for(let e of this.color_swatches){let i=e.hex.substr(1),t=s(`\n                    <div class="color-swatch"\n                         id="${i}"\n                         style="background:${e.hex}"/>\n                `);this.swatches_container.append(t),t.on("click",(()=>{this.color=e.hex,this.picker.color.hsl=e.hsl,s("div.color-swatch").length>1&&s("div.color-swatch").removeClass("selected"),t.addClass("selected")}))}}}resize_handle(e){if(s(window).width()<=450&&!this.picker_elem.hasClass("mobile")){this.picker=null,s("div.IroColorPicker",this.picker_elem).remove(),this.picker_elem.addClass("mobile");let e=.3*s(window).width();this.picker=new iro.ColorPicker(this.picker_container.get(0),{color:this.color,layoutDirection:"horizontal",width:e,display:"inline-block",layout:[{component:iro.ui.Box,options:{}},{component:iro.ui.Slider,options:{sliderType:"hue"}}]})}else s(window).width()>450&&(this.picker_elem.hasClass("mobile")&&(this.picker=null,s("div.IroColorPicker",this.picker_elem).remove(),this.picker_elem.removeClass("mobile")),this.picker||(this.picker=new iro.ColorPicker(this.picker_container.get(0),{color:this.color,layout:[{component:iro.ui.Box,options:{}},{component:iro.ui.Slider,options:{sliderType:"hue"}}]})))}update_color(){let e=this.picker.color.hexString,i=this.picker.color.hsl;this.preview_elem.css("background",e),this.elem.val(e),this.hsl_display&&(s("input.h",this.hsl_display).val(i.h),s("input.s",this.hsl_display).val(i.s),s("input.l",this.hsl_display).val(i.l)),this.hex_display&&s("input",this.hex_display).val(e)}update_hsl_value(e){e.preventDefault();let i=s(e.target),t={h:this.picker.color.hsl.h,s:this.picker.color.hsl.s,l:this.picker.color.hsl.l};switch(i.attr("class")){case"h":t.h=i.val();break;case"s":t.s=i.val();break;case"l":t.l=i.val()}this.picker.color.hsl=t}update_hex_value(e){"string"!=typeof e||"#"!==e[0]||7!==e.length||isNaN(Number("0x"+e.substring(1,7)))||(this.picker.color.hexString=e)}trigger_handle(e){"none"===this.picker_elem.css("display")?(this.picker_elem.show(),s(window).on("keydown",this.handle_keypress),s(window).on("mousedown",this.handle_click)):this.hide_elem()}handle_keypress(e){"Enter"===e.key||"Escape"===e.key?(e.preventDefault(),this.hide_elem()):"Delete"===e.key&&(e.preventDefault(),this.remove_swatch())}handle_click(e){let s=this.picker_elem;s.is(e.target)||0!==s.has(e.target).length||this.preview_elem.is(e.target)||"block"!==s.css("display")||this.hide_elem()}hide_elem(e){e&&e.preventDefault(),this.picker_elem.hide(),this.elem.blur(),s(window).off("keydown",this.handle_keypress),s(window).off("mousedown",this.handle_click)}create_swatch(e){e&&(e.preventDefault(),this.swatches_container.show());let i=this.picker.color.hsl,t=this.picker.color.hexString;for(let e of this.color_swatches)if(i.h===e.hsl.h&&i.s===e.hsl.s&&i.l===e.hsl.l)return;let l=s(`\n            <div class="color-swatch" id="${t.substr(1)}" style="background:${t}"/>\n        `);this.color_swatches.length>=12&&(this.color_swatches.shift(),s("div.color-swatch")[0].remove()),this.swatches_container.append(l),s("div.color-swatch").removeClass("selected"),l.addClass("selected");let h={hex:t,hsl:i};this.color_swatches.push(h),l.on("click",(()=>{this.color=t,this.picker.color.hsl=i,s("div.color-swatch").removeClass("selected"),l.addClass("selected")})),this.set_swatches()}remove_swatch(e){e&&e.preventDefault();let i=s("div.color-swatch.selected"),t=`#${i.attr("id")}`,l=this.color_swatches;for(let e in l)t===l[e].hex&&this.color_swatches.splice(e,1);if(i.remove(),s("div.color-swatch").last().addClass("selected"),0===this.color_swatches.length)return this.picker.color.hsl={h:0,s:0,l:100},this.color="#ffffff",void localStorage.removeItem("color-swatches");let h=this.color_swatches[this.color_swatches.length-1];this.picker.color.hsl=h.hsl,this.set_swatches()}set_swatches(){let e=JSON.stringify(this.color_swatches);localStorage.setItem("color-swatches",e)}}s((function(){void 0!==window.ts?ts.ajax.register(i.initialize,!0):i.initialize()})),e.ColorWidget=i,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.color=e}({},jQuery);
//# sourceMappingURL=widget.min.js.map
