!function(e,t,s){"use strict";class i{static initialize(e){t("input.color-picker",e).each((function(){new i(t(this))}))}constructor(e){this.picker=null,this.picker_elem=null,this.elem=e,this.elem.attr("spellcheck","false");let i=this.color_elem=t('<span class="color-picker-color" />');e.after(i);let o=this.picker_elem=t('<div class="color-picker-wrapper" />');this.color_elem.after(o);let l=this.close_btn=t('<button class="close-button">âœ•</button>');this.picker_elem.append(l),this.color="#ffffff",this.color_swatches=[],this.picker=new s.ColorPicker(o.get(0),{color:this.color,layout:[{component:s.ui.Box,options:{}},{component:s.ui.Slider,options:{sliderType:"hue"}}]}),this.elem.val(this.color),this.color_elem.css("background",this.color);let c=this.add_color_btn=t('<button class="add_color">+ Add</button>'),h=this.remove_color_btn=t('<button class="remove_color">- Remove</button>'),r=t('<div class="buttons"/>');this.picker_elem.append(r),r.append(c).append(h),this.add_color_btn.on("click",this.create_swatch.bind(this)),this.remove_color_btn.on("click",this.remove_swatch.bind(this));let a=this.swatches_container=t('\n            <div class="color-picker-recent"></div>\n        ');this.picker_elem.append(a),this.trigger_handle=this.trigger_handle.bind(this),e.on("focus",this.trigger_handle),i.on("click",this.trigger_handle),this.update_color=this.update_color.bind(this),this.picker.on("color:change",this.update_color),this.hide_elem=this.hide_elem.bind(this),this.close_btn.on("click",this.hide_elem),this.handle_keypress=this.handle_keypress.bind(this),this.handle_click=this.handle_click.bind(this),this.init_swatches()}init_swatches(){let e=localStorage.getItem("color-swatches");if(e){this.swatches_container.show(),this.color_swatches=JSON.parse(e);for(let e of this.color_swatches){let s=t(`\n                    <div class="color-swatch" id="${e.hex}" style="background:${e.hex}"/>\n                `);this.swatches_container.append(s),s.on("click",(()=>{this.color=e.color,this.picker.color.hsl=e.hsl,t("div.color-swatch").length>1&&t("div.color-swatch").removeClass("selected"),s.addClass("selected")}))}}}update_color(){let e=this.picker.color.hexString;this.color_elem.css("background",e),this.elem.val(e)}trigger_handle(e){e.preventDefault(),"none"===this.picker_elem.css("display")?(this.picker_elem.show(),t(window).on("keydown",this.handle_keypress),t(window).on("mousedown",this.handle_click)):this.hide_elem()}handle_keypress(e){e.preventDefault(),"Enter"===e.key||"Escape"===e.key?this.hide_elem():"Delete"===e.key&&this.remove_swatch()}handle_click(e){let t=this.picker_elem;t.is(e.target)||0!==t.has(e.target).length||this.color_elem.is(e.target)||"block"!==t.css("display")||this.hide_elem()}hide_elem(e){e&&e.preventDefault(),this.picker_elem.hide(),this.elem.blur(),t(window).off("keydown",this.handle_keypress),t(window).off("mousedown",this.handle_click)}create_swatch(e){e&&(e.preventDefault(),this.swatches_container.show());let s=this.picker.color.hsl,i=this.picker.color.hexString;for(let e of this.color_swatches)if(e.hex===i)return;let o=t(`\n            <div class="color-swatch" id="${i}" style="background:${i}"/>\n        `);this.color_swatches.length>=12&&(this.color_swatches.shift(),t("div.color-swatch")[0].remove()),this.swatches_container.append(o);let l={hex:i,hsl:s};this.color_swatches.push(l),o.on("click",(e=>{this.color=i,this.picker.color.hsl=s,t("div.color-swatch").removeClass("selected"),o.addClass("selected")})),this.set_swatches()}remove_swatch(e){e&&e.preventDefault();let s=t("div.color-swatch.selected"),i=s.attr("id"),o=this.color_swatches;for(let e in o)i===o[e].hex&&this.color_swatches.splice(e,1);s.remove(),this.set_swatches()}set_swatches(){let e=JSON.stringify(this.color_swatches);localStorage.setItem("color-swatches",e)}}t((function(){void 0!==window.ts?ts.ajax.register(i.initialize,!0):i.initialize()})),e.ColorWidget=i,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.color=e}({},jQuery,iro);
//# sourceMappingURL=widget.min.js.map
