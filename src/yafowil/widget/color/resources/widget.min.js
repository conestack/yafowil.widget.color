!function(e,s){"use strict";class t{static initialize(e){s("input.color-picker",e).each((function(){new t(s(this),{hsl_display:!0,hex_display:!0})}))}constructor(e,t){this.elem=e,this.elem.data("color_widget",this).attr("spellcheck","false").attr("maxlength",7),this.dropdown_elem=s('<div class="color-picker-wrapper" />'),this.picker_container=s('<div class="color-picker-container" />'),this.close_btn=s('<button class="close-button" />').text("âœ•"),this.add_color_btn=s('<button class="add_color" />').text("+ Add"),this.remove_color_btn=s('<button class="remove_color" />').text("- Remove"),this.buttons=s('<div class="buttons"/>').append(this.add_color_btn).append(this.remove_color_btn),this.swatches_container=s('<div class="color-picker-recent" />'),this.dropdown_elem.append(this.picker_container).append(this.close_btn).append(this.buttons).append(this.swatches_container),this.picker=new iro.ColorPicker(this.picker_container.get(0),{color:this.color,layout:[{component:iro.ui.Box,options:{}},{component:iro.ui.Slider,options:{sliderType:"hue"}}]}),this.resize_handle=this.resize_handle.bind(this),this.resize_handle(),s(window).on("resize",this.resize_handle),this.create_swatch=this.create_swatch.bind(this),this.add_color_btn.on("click",this.create_swatch),this.remove_swatch=this.remove_swatch.bind(this),this.remove_color_btn.on("click",this.remove_swatch),this.init_options(t),this.color_swatches=[];let h=localStorage.getItem("color-swatches");if(h){this.swatches_container.show();let e=JSON.parse(h);for(let s of e)this.color_swatches.push(new i(this,s.hex,s.hsl));this.active_swatch=this.color_swatches[this.color_swatches.length-1],this.active_swatch.select(),this.hex=this.active_swatch.hex,this.hsl=this.active_swatch.hsl}else this.hex="#ffffff",this.hsl={h:0,s:0,l:100};this.elem.val(this.hex),this.preview_elem.css("background",this.hex),this.trigger_handle=this.trigger_handle.bind(this),this.elem.on("focus",this.trigger_handle),this.preview_elem.on("click",this.trigger_handle),this.elem.on("input",(()=>{let e=this.elem.val();0===e.length&&this.elem.val("#"),this.hex=e})),this.update_color=this.update_color.bind(this),this.picker.on("color:change",this.update_color),this.hide_elem=this.hide_elem.bind(this),this.close_btn.on("click",this.hide_elem),this.handle_keypress=this.handle_keypress.bind(this),this.handle_click=this.handle_click.bind(this)}get hex(){return this._hex}set hex(e){"string"!=typeof e||"#"!==e[0]||7!==e.length||isNaN(Number("0x"+e.substring(1,7)))||(this._hex=e,this.picker.color.hexString=e,this.elem.val(e),this.hex_display&&s("input",this.hex_display).val(e))}get hsl(){return this._hsl}set hsl(e){this.hsl_display&&(s("input.h",this.hsl_display).val(e.h),s("input.s",this.hsl_display).val(e.s),s("input.l",this.hsl_display).val(e.l)),this.picker.color.hsl=e,this._hsl=e}init_options(e){let t=e.preview_elem,i=e.hsl_display,h=e.hex_display;if(t?(this.preview_elem=e.preview_elem,this.elem.after(this.dropdown_elem)):(this.preview_elem=s('\n                <span class="color-picker-color" />\n            '),this.elem.after(this.preview_elem),this.preview_elem.after(this.dropdown_elem)),i){let e=this.picker.color.hsl;this.hsl_display=s(`\n                <div class="hsl-display">\n                  <div>\n                    H:\n                    <input class="h" type="number" value="${e.h}"\n                        min="0", max="360" />\n                  </div>\n                  <div>\n                    S:\n                    <input class="s" type="number" value="${e.s}"\n                        min="0", max="100" />\n                  </div>\n                  <div>\n                    L:\n                    <input class="l" type="number" value="${e.l}"\n                        min="0", max="100" />\n                  </div>\n                </div>\n            `),this.dropdown_elem.append(this.hsl_display),this.handle_hsl_input=this.handle_hsl_input.bind(this),s("input",this.hsl_display).on("input",this.handle_hsl_input)}else this.buttons.addClass("hsl-false");if(h){let e=this.hex_display=s(`\n                <div class="hex-display">\n                  HEX:\n                  <input value="${this.picker.color.hexString}"\n                    spellcheck="false" maxlength="7" />\n                </div>\n            `);this.dropdown_elem.append(e);let t=this.picker.color.hexString;this.hex_display.val(t),this.handle_hex_input=this.handle_hex_input.bind(this),s("input",this.hex_display).on("input",this.handle_hex_input)}}resize_handle(e){if(s(window).width()<=450){this.dropdown_elem.hasClass("mobile")||(this.dropdown_elem.addClass("mobile"),this.picker.state.layoutDirection="horizontal");let e=.3*s(window).width();this.picker.resize(e)}else s(window).width()>450&&this.dropdown_elem.hasClass("mobile")&&(this.dropdown_elem.removeClass("mobile"),this.picker.state.layoutDirection="vertical",this.picker.resize(300))}handle_hsl_input(e){e.preventDefault();let t=s(e.target),i=this.picker.color.hsl;switch(t.attr("class")){case"h":i.h=t.val();break;case"s":i.s=t.val();break;case"l":i.l=t.val()}this.picker.color.hsl=i}handle_hex_input(e){let t=s(e.currentTarget).val();0===t.length&&s(e.currentTarget).val("#"),this.hex=t}update_color(){this.hex=this.picker.color.hexString,this.hsl=this.picker.color.hsl,this.preview_elem.css("background",this.hex),this.elem.val(this.hex)}trigger_handle(e){"none"===this.dropdown_elem.css("display")?(this.dropdown_elem.show(),s(window).on("keydown",this.handle_keypress),s(window).on("mousedown",this.handle_click)):this.hide_elem()}handle_keypress(e){"Enter"===e.key||"Escape"===e.key?(e.preventDefault(),this.hide_elem()):"Delete"===e.key&&(e.preventDefault(),this.remove_swatch())}handle_click(e){let s=this.dropdown_elem;s.is(e.target)||0!==s.has(e.target).length||this.preview_elem.is(e.target)||"block"!==s.css("display")||this.hide_elem()}hide_elem(e){e&&e.preventDefault(),this.dropdown_elem.hide(),this.elem.blur(),s(window).off("keydown",this.handle_keypress),s(window).off("mousedown",this.handle_click)}create_swatch(e){e&&(e.preventDefault(),this.swatches_container.show());let s=this.picker.color.hsl,t=this.picker.color.hexString;for(let e of this.color_swatches)if(s.h===e.hsl.h&&s.s===e.hsl.s&&s.l===e.hsl.l)return;let h=new i(this,t,s);this.color_swatches.push(h),h.select(),this.color_swatches.length>12&&(this.color_swatches[0].destroy(),this.color_swatches.shift()),this.set_swatches()}remove_swatch(e){e&&e.preventDefault(),this.active_swatch.destroy();let s=this.color_swatches.indexOf(this.active_swatch);this.color_swatches.splice(s,1);let t=this.color_swatches[this.color_swatches.length-1];if(0===this.color_swatches.length)return this.picker.color.hsl={h:0,s:0,l:100},this.hex="#ffffff",void localStorage.removeItem("color-swatches");t.select(),this.picker.color.hsl=t.hsl,this.hex=t.hex,this.set_swatches()}set_swatches(){let e=[];for(let s of this.color_swatches)e.push({hex:s.hex,hsl:s.hsl});localStorage.setItem("color-swatches",JSON.stringify(e))}}class i{constructor(e,t,i){this.elem=s(`\n            <div class="color-swatch"\n                id="${t.substr(1)}"\n                style="background:${t}"\n            />\n        `),this.widget=e,this.widget.swatches_container.append(this.elem),this.hex=t,this.hsl=i,this.destroy=this.destroy.bind(this),this.select=this.select.bind(this),this.elem.on("click",this.select)}destroy(){this.elem.off("click",this.select),this.elem.remove()}select(e){s("div.color-swatch").removeClass("selected"),this.elem.addClass("selected"),this.widget.active_swatch=this,this.widget.hex=this.hex,this.widget.hsl=this.hsl}}s((function(){void 0!==window.ts?ts.ajax.register(t.initialize,!0):t.initialize()})),e.ColorWidget=t,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.color=e}({},jQuery);
//# sourceMappingURL=widget.min.js.map
